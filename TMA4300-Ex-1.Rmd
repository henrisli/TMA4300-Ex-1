--- 
title: 'TMA4300 Computer Intensive Statistical Methods Exercise 1'
output:
  pdf_document:
    toc: yes
    toc_depth: '2'
  html_document:
    toc: yes
    toc_depth: 2
    toc_float: yes
date: "`r format(Sys.time(), '%d.%m.%Y')`"
subtitle: 'Group members: Henrik Syversveen Lie, Mikal Stapnes (SKRIVE STUDENTNUMMER I STEDET??)'
---


```{r setup, include = FALSE}
library(formatR)
showsol <- FALSE
library(knitr)
opts_chunk$set(tidy.opts = list(width.cutoff = 68), tidy = TRUE, warning = FALSE, error = FALSE, message = FALSE, echo = TRUE)
```

# Problem A: Stochastic simulation by the probability integral transform and bivariate techniques



# Problem B: The gamma distribution

We can sample from the gamma distribution 

$$ f(x) = \begin{cases}
\frac{1}{\Gamma(\alpha)}x^{\alpha-1}e^{-x} \\
0, \quad \text{otherwise}. \\
\end{cases} $$



using the distribution found in A.2 as a proposal distribution. We can do this because the A.2 distribution is nonzero at all point where $f(x)$ is nonzero

```{r}
library(pracma)
f_A2 = function(c, x, alpha){
  result = vector(length = length(x))
  result[x<1] = sapply(x[x<1], function(x) c*x^(alpha - 1))
  result[x>=1] = sapply(x[x>=1], function(x) c*exp(-x))
  return(result)
}

x = linspace(0, 10, 100)
y_gamma = dgamma(x, 3)
y_prop = f_A2(1, x, 3)

plot1 = plot(x, y_gamma, col='red', type='l', ylab="", ylim = c(0., 1.))
lines(x, y_prop, type='l', col='blue')
legend(x="topright", .95, legend=c("Gamma", "Proposal"), col=c('red', 'blue'), lty=1, cex=0.8)
```
We note that the acceptance probabiltiy, P_{accept}, 

$$P_{accept} = \int_0^{\infty} P_{unif}(U \leq \frac{f(x)}{c g(x)} ) P_{prop}(X = x) \\
 = \int_0^{\infty} \frac{f(x)}{c g(x)} g(x) = c^{-1}$$

```{r}
sample_f = function(size=1, f){
  uniform = runif(size=length(x))
  
}
  
```

